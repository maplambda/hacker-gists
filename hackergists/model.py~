import db

redis = db.redis


def store(gist, id):
    db.store(id, gist)

def exists(id):
    return db.exists(id)

def latest_gist():
    """ return lastest gist in index """
    return redis.zrevrange('index', 0, 0)

def index_add(id=None, score=None):
    redis.zadd('index', score, id)

def index_clear():
    redis.zremrangebyrank('index', 0, -1)

def recent_gists(start=None):
    start = 0 if start == None else start
    end = start + 30 if start is not None else -1
    return map(lambda x: db.get(x), 
               redis.zrevrange('index', start, end))

